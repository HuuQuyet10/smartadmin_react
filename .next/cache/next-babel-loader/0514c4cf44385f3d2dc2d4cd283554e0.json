{"ast":null,"code":"import _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport constants from \"@strings\";\nimport snackbar from \"@utils/snackbar-utils\";\nimport stringUtils from \"mainam-react-native-string-utils\";\nimport clientUtils from \"@utils/client-utils\";\nimport userProvider from '@data-access/user-provider';\n\nfunction onLogin(username, password) {\n  return function (dispath, getState) {\n    if (!username || !password) {\n      snackbar.show(\"Vui lòng nhập tài khoản và mật khẩu\", \"danger\");\n      return;\n    }\n\n    return new _Promise(function (resolve, reject) {\n      userProvider.login(username, password).then(function (res) {\n        debugger;\n\n        switch (res.code) {\n          case 0:\n            snackbar.show(\"Đăng nhập thành công\", \"success\");\n            dispath(updateData({\n              auth: res.data,\n              detail: null\n            }));\n            clientUtils.auth = res.data.access_token || \"\";\n            resolve(res.data);\n            break;\n\n          default:\n            snackbar.show(res.message || constants.text.user.login_error, \"danger\");\n            break;\n        }\n\n        reject(\"Đăng nhập không thành công\");\n      })[\"catch\"](function (e) {\n        reject(e);\n        console.log(e);\n      });\n    });\n  };\n}\n\nfunction updateData(data) {\n  return function (dispatch) {\n    dispatch({\n      type: \"AUTH-UPDATE-DATA\",\n      data: data\n    });\n  };\n}\n\nexport default {\n  onLogin: onLogin,\n  onLogout: function onLogout() {\n    return function (dispatch) {\n      return new _Promise(function (resolve, reject) {\n        dispatch(updateData({\n          auth: null,\n          detail: null\n        }));\n        clientUtils.auth = null;\n        resolve();\n      });\n    };\n  },\n  updateData: updateData\n};","map":{"version":3,"sources":["E:/iSofh/source/project-react-js-device-management/src/redux-store/actions/auth/index.js"],"names":["constants","snackbar","stringUtils","clientUtils","userProvider","onLogin","username","password","dispath","getState","show","resolve","reject","login","then","res","code","updateData","auth","data","detail","access_token","message","text","user","login_error","e","console","log","dispatch","type","onLogout"],"mappings":";AAAA,OAAOA,SAAP,MAAsB,UAAtB;AACA,OAAOC,QAAP,MAAqB,uBAArB;AACA,OAAOC,WAAP,MAAwB,kCAAxB;AACA,OAAOC,WAAP,MAAwB,qBAAxB;AACA,OAAOC,YAAP,MAAyB,4BAAzB;;AAEA,SAASC,OAAT,CAAiBC,QAAjB,EAA2BC,QAA3B,EAAqC;AACnC,SAAO,UAACC,OAAD,EAAUC,QAAV,EAAuB;AAC5B,QAAI,CAACH,QAAD,IAAa,CAACC,QAAlB,EAA4B;AAC1BN,MAAAA,QAAQ,CAACS,IAAT,CAAc,qCAAd,EAAoD,QAApD;AACA;AACD;;AACD,WAAO,aAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCR,MAAAA,YAAY,CACTS,KADH,CACSP,QADT,EACmBC,QADnB,EAEGO,IAFH,CAEQ,UAAAC,GAAG,EAAI;AACX;;AACA,gBAAQA,GAAG,CAACC,IAAZ;AACE,eAAK,CAAL;AACEf,YAAAA,QAAQ,CAACS,IAAT,CAAc,sBAAd,EAAsC,SAAtC;AACAF,YAAAA,OAAO,CACLS,UAAU,CAAC;AACTC,cAAAA,IAAI,EAAEH,GAAG,CAACI,IADD;AAETC,cAAAA,MAAM,EAAE;AAFC,aAAD,CADL,CAAP;AAMAjB,YAAAA,WAAW,CAACe,IAAZ,GAAmBH,GAAG,CAACI,IAAJ,CAASE,YAAT,IAAyB,EAA5C;AACAV,YAAAA,OAAO,CAACI,GAAG,CAACI,IAAL,CAAP;AACA;;AACF;AACElB,YAAAA,QAAQ,CAACS,IAAT,CACEK,GAAG,CAACO,OAAJ,IAAetB,SAAS,CAACuB,IAAV,CAAeC,IAAf,CAAoBC,WADrC,EAEE,QAFF;AAIA;AAjBJ;;AAmBAb,QAAAA,MAAM,CAAC,4BAAD,CAAN;AACD,OAxBH,WAyBS,UAAAc,CAAC,EAAI;AACVd,QAAAA,MAAM,CAACc,CAAD,CAAN;AACAC,QAAAA,OAAO,CAACC,GAAR,CAAYF,CAAZ;AACD,OA5BH;AA6BD,KA9BM,CAAP;AA+BD,GApCD;AAqCD;;AAED,SAAST,UAAT,CAAoBE,IAApB,EAA0B;AACxB,SAAO,UAAAU,QAAQ,EAAI;AACjBA,IAAAA,QAAQ,CAAC;AACPC,MAAAA,IAAI,EAAE,kBADC;AAEPX,MAAAA,IAAI,EAAEA;AAFC,KAAD,CAAR;AAID,GALD;AAMD;;AACD,eAAe;AACbd,EAAAA,OAAO,EAAPA,OADa;AAEb0B,EAAAA,QAFa,sBAEF;AACT,WAAO,UAAAF,QAAQ,EAAI;AACjB,aAAO,aAAY,UAAClB,OAAD,EAAUC,MAAV,EAAqB;AACtCiB,QAAAA,QAAQ,CACNZ,UAAU,CAAC;AACTC,UAAAA,IAAI,EAAE,IADG;AAETE,UAAAA,MAAM,EAAE;AAFC,SAAD,CADJ,CAAR;AAMAjB,QAAAA,WAAW,CAACe,IAAZ,GAAmB,IAAnB;AACAP,QAAAA,OAAO;AACR,OATM,CAAP;AAUD,KAXD;AAYD,GAfY;AAgBbM,EAAAA,UAAU,EAAVA;AAhBa,CAAf","sourcesContent":["import constants from \"@strings\";\r\nimport snackbar from \"@utils/snackbar-utils\";\r\nimport stringUtils from \"mainam-react-native-string-utils\";\r\nimport clientUtils from \"@utils/client-utils\";\r\nimport userProvider from '@data-access/user-provider';\r\n\r\nfunction onLogin(username, password) {\r\n  return (dispath, getState) => {\r\n    if (!username || !password) {\r\n      snackbar.show(\"Vui lòng nhập tài khoản và mật khẩu\",\"danger\");\r\n      return;\r\n    }\r\n    return new Promise((resolve, reject) => {\r\n      userProvider\r\n        .login(username, password)\r\n        .then(res => {\r\n          debugger;\r\n          switch (res.code) {\r\n            case 0:\r\n              snackbar.show(\"Đăng nhập thành công\", \"success\");\r\n              dispath(\r\n                updateData({\r\n                  auth: res.data,\r\n                  detail: null\r\n                })\r\n              );\r\n              clientUtils.auth = res.data.access_token || \"\";\r\n              resolve(res.data);\r\n              break;\r\n            default:\r\n              snackbar.show(\r\n                res.message || constants.text.user.login_error,\r\n                \"danger\"\r\n              );\r\n              break;\r\n          }\r\n          reject(\"Đăng nhập không thành công\");\r\n        })\r\n        .catch(e => {\r\n          reject(e);\r\n          console.log(e);\r\n        });\r\n    });\r\n  };\r\n}\r\n\r\nfunction updateData(data) {\r\n  return dispatch => {\r\n    dispatch({\r\n      type: \"AUTH-UPDATE-DATA\",\r\n      data: data\r\n    });\r\n  };\r\n}\r\nexport default {\r\n  onLogin,\r\n  onLogout() {\r\n    return dispatch => {\r\n      return new Promise((resolve, reject) => {\r\n        dispatch(\r\n          updateData({\r\n            auth: null,\r\n            detail: null\r\n          })\r\n        );\r\n        clientUtils.auth = null;\r\n        resolve();\r\n      });\r\n    };\r\n  },\r\n  updateData\r\n};\r\n"]},"metadata":{},"sourceType":"module"}